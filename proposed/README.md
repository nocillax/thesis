# Blockchain-Based Certificate Management System (Proposed System)

Decentralized certificate issuance and verification using Quorum blockchain with IBFT consensus.

---

## Prerequisites

- Node.js >= 18
- Docker & Docker Compose
- PostgreSQL >= 14
- npm or yarn

---

## Setup Instructions

### 1. Clone Repository

```bash
git clone https://github.com/yourusername/thesis.git
cd thesis/proposed
```

### 2. Generate Quorum Network

```bash
# Install Quorum dev quickstart globally
npm install -g quorum-dev-quickstart

# Generate 4-node IBFT network in current directory
npx quorum-dev-quickstart

# Select when prompted:
# - Consensus: IBFT 2.0
# - Number of nodes: 4
# - Block time: 1 second

# This creates quorum-test-network/ folder
```

### 3. Start Blockchain Network

```bash
cd quorum-test-network
docker-compose up -d

# Wait ~30 seconds for network initialization

# Verify all 4 nodes running
docker ps
# Should show: node1, node2, node3, node4
```

### 4. Deploy Smart Contracts

```bash
cd ../blockchain
npm install

# Create .env file
cp .env.example .env
# Edit .env with:
# - RPC_URL=http://localhost:8545
# - PRIVATE_KEY=<your_private_key>

# Deploy contracts
npx hardhat run scripts/deploy.js --network quorum

# Save the contract addresses shown in terminal output
```

### 5. Setup Backend

```bash
cd ../backend
npm install

# Create database
createdb proposed_certificates

# Create .env file
cp .env.example .env
# Edit .env with:
# - Database credentials
# - Contract addresses from step 4
# - JWT secret
# - Encryption key
```

### 6. Start Backend

```bash
npm run start:dev
```

**Expected Output:**

```
✅ Blockchain connected
✅ Admin seeded: admin / admin123
Listening on port 3001
```

---

## What Gets Auto-Generated (Not in Git)

- `quorum-test-network/` - Generated by npx command
- `blockchain/artifacts/` - Hardhat build outputs
- `blockchain/cache/` - Hardhat cache
- `node_modules/` - NPM dependencies

**Only source code, configs, and .env.example are in git.**

---

## Testing

See [TESTING_GUIDE.md](./TESTING_GUIDE.md) for complete API testing instructions.

---

## Key Features

- **Per-User Wallets**: Each user has encrypted private key in database
- **Backend Signing**: Backend decrypts keys to sign transactions
- **IBFT Consensus**: 4 validators, Byzantine fault tolerant
- **Immutable Records**: Certificates permanent after blockchain consensus
- **Cryptographic Proof**: Signatures verify issuer identity

---

## Troubleshooting

**Blockchain not connecting:**

```bash
# Check nodes running
docker ps

# Check node1 logs
cd quorum-test-network
docker-compose logs node1

# Test RPC
curl -X POST http://localhost:8545 \
  -H "Content-Type: application/json" \
  -d '{"jsonrpc":"2.0","method":"eth_blockNumber","params":[],"id":1}'
```

**Contract deployment failed:**

```bash
# Verify .env has correct RPC_URL and PRIVATE_KEY
cat blockchain/.env

# Check Hardhat config
npx hardhat console --network quorum
```

**Backend can't connect to database:**

```bash
# Verify PostgreSQL running
sudo systemctl status postgresql

# Check database exists
psql -U postgres -l | grep proposed_certificates
```

---

## Comparison with Control System

See [../control/](../control/) for traditional centralized implementation.

| Feature       | Proposed (This)           | Control                    |
| ------------- | ------------------------- | -------------------------- |
| Storage       | Blockchain + PostgreSQL   | PostgreSQL only            |
| Immutability  | Immutable after consensus | Mutable (admin can change) |
| Trust         | Cryptography + consensus  | Trust server/admin         |
| Verification  | Cryptographic proof       | Query API (trust backend)  |
| Issuance Time | ~1-2 seconds (consensus)  | ~10-50ms (database insert) |
| Complexity    | Complex (blockchain)      | Simple (REST API)          |
